## ä¸€ã€ å…³äºå¾®å‰ç«¯ï¼š
```
  å¾®å‰ç«¯çš„æ¦‚å¿µè¯ç”Ÿäº2016å¹´ï¼Œç”±ThoughtWorksåœ¨2016å¹´æå‡ºçš„ï¼Œå®ƒå€Ÿé‰´äº†å¾®æœåŠ¡çš„æ¶æ„ç†å¿µï¼Œæ ¸å¿ƒæ€æƒ³åœ¨äºï¼šå°†ä¸€ä¸ªåºå¤§çš„å‰ç«¯åº”ç”¨æ‹†åˆ†æˆå¤šä¸ªç‹¬ç«‹çµæ´»çš„å°å‹åº”ç”¨ï¼Œæ¯ä¸ªåº”ç”¨å¯ä»¥ç‹¬ç«‹å¼€å‘ã€è¿è¡Œå’Œéƒ¨ç½²ã€‚è¿™äº›å°å‹åº”ç”¨å¯ä»¥èåˆä¸ºä¸€ä¸ªå®Œæ•´çš„åº”ç”¨ï¼Œå¾®å‰ç«¯å¯ä»¥å°†å¤šä¸ªé¡¹ç›®åˆè€Œä¸ºä¸€ï¼Œä¹Ÿå¯ä»¥å‡å°‘é¡¹ç›®é—´çš„è€¦åˆï¼Œæå‡é¡¹ç›®æ‰©å±•æ€§ï¼›ç›¸æ¯”ä¸€ä¸ªæ•´ä½“çš„å‰ç«¯ä»“åº“ï¼Œå¾®å‰ç«¯æ¶æ„ä¸‹çš„å‰ç«¯ä»“åº“æ›´å°æ›´çµæ´»ã€‚
```

> å¾®å‰ç«¯ä¸»è¦è§£å†³ä¸¤ä¸ªé—®é¢˜
```
1ã€éšç€é¡¹ç›®è¿­ä»£åº”ç”¨è¶Šæ¥è¶Šåºå¤§ï¼Œéš¾ä»¥ç»´æŠ¤ã€‚
2ã€è·¨å›¢é˜Ÿæˆ–è·¨éƒ¨é—¨åä½œå¼€å‘é¡¹ç›®å¯¼è‡´æ•ˆç‡ä½ä¸‹çš„é—®é¢˜ã€‚
```
![image](https://s3.bmp.ovh/imgs/2022/02/e186bde01d5d76b2.png)

## äºŒã€å…³äºå¾®å‰ç«¯æ¡†æ¶ï¼šmicro-app
åœ¨ **microApp** ä¹‹å‰ï¼Œå‰ç«¯ä¸šç•Œå·²ç»æœ‰æ¯”è¾ƒæµè¡Œçš„å¾®å‰ç«¯å¼€æºæ¡†æ¶ï¼š**single-spa** å’Œ **qiankun**, ä»–ä»¬çš„å®ç°æ ¸å¿ƒæ€è·¯æ˜¯ï¼š
```
  1ã€single-spa é€šè¿‡ç›‘å¬url changeçš„äº‹ä»¶ï¼Œåœ¨è·¯ç”±å˜åŒ–æ—¶ï¼ŒåŒ¹é…åˆ°è¦æ¸²æŸ“çš„å­åº”ç”¨å¹¶è¿›è¡Œæ¸²æŸ“ï¼Œè¿™ä¸ªæ€è·¯æ˜¯ç›®å‰å¾®å‰ç«¯ä¸»æµå®ç°ã€‚è¿™ä¸ªæ–¹æ¡ˆè¦æ±‚å­åº”ç”¨ä¿®æ”¹æ¸²æŸ“é€»è¾‘å¹¶æš´éœ²å‡ºä¸‰ä¸ªæ–¹æ³•ï¼šbootstrapã€mountå’Œunmount ï¼Œ åˆ†åˆ«å¯¹åº”åˆå§‹åŒ–ã€æ¸²æŸ“å’Œå¸è½½ï¼Œè¿™ä¹Ÿå¯¼è‡´å­åº”ç”¨éœ€è¦å¯¹å…¥å£æ–‡ä»¶è¿›è¡Œä¿®æ”¹ï¼Œ
  2ã€qiankun æ˜¯åŸºäºsingle-spa è¿›è¡Œå°è£…ï¼Œæ‰€ä»¥è¿™äº›ç‰¹ç‚¹ä¹Ÿè¢« qiankun ç»§æ‰¿ä¸‹æ¥ï¼Œå¹¶ä¸”éœ€è¦å¯¹webpackè¿›è¡Œä¸€äº›ä¿®æ”¹ã€‚
```

è€Œ **micro-app** å¹¶æ²¡æœ‰æ²¿è¢­ **single-spa** çš„æ€è·¯ï¼Œè€Œæ˜¯å€Ÿé‰´äº†webComponentæ€æƒ³ï¼Œé€šè¿‡è‡ªå®šä¹‰å…ƒç´ å’Œè‡ªå®šä¹‰çš„shadowDomï¼Œ å°†å¾®å‰ç«¯å°è£…æˆä¸€ä¸ªç±»WebComponentç»„ä»¶ï¼Œä»è€Œå®ç°å¾®å‰ç«¯çš„ç»„ä»¶åŒ–æ¸²æŸ“ã€‚å¹¶ä¸”ç”±äºè‡ªå®šä¹‰ShadowDomçš„éš”ç¦»ç‰¹æ€§ï¼Œ**micro-app** ä¸éœ€è¦åƒå‰ä¸¤ä¸ªæ¡†æ¶ä¸€æ ·è¦æ±‚å¯¹å­åº”ç”¨è¿›è¡Œé€»è¾‘ä¿®æ”¹ã€æ–¹æ³•æš´éœ²å’Œwebpacké…ç½®ä¿®æ”¹ï¼Œæ˜¯æ¥å…¥æˆæœ¬æœ€ä½çš„æ–¹æ¡ˆã€‚

ç¤ºæ„å›¾

![image](https://s3.bmp.ovh/imgs/2022/02/44238c92c5c5103f.png)

**micro-app** å°†æ‰€æœ‰åŠŸèƒ½éƒ½å°è£…åˆ°ä¸€ä¸ªç±»WebComponentç»„ä»¶ä¸­ï¼Œä»è€Œå®ç°åœ¨åŸºåº§åº”ç”¨ä¸­åµŒå…¥ä¸€è¡Œä»£ç å³å¯æ¸²æŸ“ä¸€ä¸ªå¾®å‰ç«¯åº”ç”¨ï¼Œ åŒæ—¶æä¾› **jsæ²™ç®±**ã€**æ ·å¼éš”ç¦»**ã€**å…ƒç´ éš”ç¦»**ã€**é¢„åŠ è½½**ã€**æ•°æ®é€šä¿¡**ã€**é™æ€èµ„æºè¡¥å…¨**ç­‰ä¸€ç³»åˆ—åŠŸèƒ½ã€‚


## ä¸‰ã€å­åº”ç”¨æ”¹é€ ï¼šç”¨micro-appå°†ç³»ç»Ÿæ”¹é€ ä½œä¸ºå­åº”ç”¨åµŒå…¥
ç¬¬ä¸€ä¸ªæ¡ˆä¾‹ï¼Œæˆ‘ä»¬çš„ç³»ç»ŸæŠ€æœ¯æ ˆé‡‡ç”¨vue2.x å¹¶ä½œä¸ºå­åº”ç”¨ï¼Œç›®æ ‡åµŒå…¥çš„åŸºåº§é‡‡ç”¨react16ã€‚å­åº”ç”¨å’ŒåŸºåº§åº”ç”¨çš„è·¯ç”±æ¨¡å¼åˆ†åˆ«æ˜¯ï¼šhashå’Œhistoryã€‚
> æ³¨æ„è¦ç‚¹

### **1ã€ä½¿ç”¨ç›¸åŒåè®®**
```
åŸºåº§å’Œå­åº”ç”¨ä½¿ç”¨ç›¸åŒåè®®ï¼Œå¦‚httpåŸŸåç³»ç»ŸåµŒå…¥httpåŸŸåçš„ç³»ç»Ÿï¼Œ httpsåŸŸåç³»ç»ŸåµŒå…¥httpsåŸŸåçš„ç³»ç»ŸåµŒå…¥ã€‚
```
### **2ã€è·¨åŸŸæ”¯æŒ**
```
ç”±äºå¾®å‰ç«¯å­åº”ç”¨å‘é€çš„fetchè¯·æ±‚æ˜¯åœ¨åŸºåº§åº”ç”¨çš„åŸŸåä¸‹ï¼Œæ‰€ä»¥ä¸ºè§£å†³è·¨åŸŸé—®é¢˜ï¼Œéœ€è¦å­åº”ç”¨å…è®¸åŸºåº§åº”ç”¨çš„å‰åç«¯è·¨åŸŸæ”¯æŒã€‚
```
åœ¨vue.config.jsä¸­é…ç½®
```typescript
  devServer: {
    headers: {
      'Access-Control-Allow-Origin': '*',
    }
  }
```
æˆ–nginxä¸­
```nginx
  add_header Access-Control-Allow-Origin *;
```

è®¾ç½®ä»¥ä¸Šè·¨åŸŸé…ç½®åï¼Œè¿˜éœ€æ³¨æ„ï¼šè‹¥åŸºåº§å’Œå­åº”ç”¨éƒ½é‡‡ç”¨httpåè®®ï¼Œåœ¨ç‰ˆæœ¬94åŠä»¥åçš„Chromeæµè§ˆå™¨ä¸Šè¿è¡Œæ—¶ï¼Œå› ä¸ºChromeçš„å®‰å…¨ç­–ç•¥è¾ƒä¸¥æ ¼å¯èƒ½ä¼šå‡ºç°å¦‚ä¸‹è·¨åŸŸé—®é¢˜ï¼š
```
xxx has been blocked by CORS policy: The request client is not a secure context and the resource is in more-private address space `private`
```

è§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š
```
  ï¼ˆ1ï¼‰å­åº”ç”¨å’ŒåŸºåº§åº”ç”¨éœ€å°†ä»£ç å‘å¸ƒåˆ°vipçš„æœºå™¨ä¸Šï¼Œévipçš„æœºå™¨è¯·æ±‚æ—¶å¯èƒ½ä¼šè¢«è®¤ä¸ºæ˜¯æ›´ç§æœ‰çš„åŸŸåï¼Œåœ¨è¯·æ±‚æ—¶å¯èƒ½å‘ç”Ÿè·¨åŸŸã€‚
  ï¼ˆ2ï¼‰å­åº”ç”¨å’ŒåŸºåº§åº”ç”¨åè®®æ”¹ä¸ºhttpsã€‚
  ï¼ˆ3ï¼‰ä¸´æ—¶æ–¹æ¡ˆï¼šä½¿ç”¨Chromeä½ç‰ˆæœ¬æˆ–å…¶ä»–æµè§ˆå™¨ã€‚
  ï¼ˆ4ï¼‰ä¸´æ—¶æ–¹æ¡ˆï¼šåœ¨Chromeæµè§ˆå™¨åœ°å€æ æœç´¢chrome://flagsï¼Œç„¶ååœ¨æœç´¢æ¡†æœç´¢Block insecure private network requests ï¼Œæœ€åå°†å…¶Defaultæ”¹ä¸ºDisabledã€‚
```

### **3ã€è·¯ç”±è®¾ç½®**
> ï¼ˆ1ï¼‰è‹¥å½“å‰åŸºåº§åº”ç”¨æ˜¯historyï¼Œä¹Ÿæ˜¯åŸºåº§æœ€æ¨èä½¿ç”¨çš„è·¯ç”±æ¨¡å¼ï¼Œåˆ™å­åº”ç”¨å¯ä»¥æ˜¯historyæˆ–è€…hashæ¨¡å¼

```
å½“åŸºåº§historyï¼Œ å­åº”ç”¨hash, åˆ™å¯ä»¥æ”¯æŒç›´æ¥åµŒå…¥ï¼ˆå› hashä¼˜å…ˆçº§è¾ƒä½ï¼ŒåŸºåº§urlæ”¹å˜æ—¶ä¼šè¦†ç›–ï¼‰
```
```JavaScript
å½“åŸºåº§historyï¼Œ å­åº”ç”¨historyçš„æƒ…å†µï¼Œå­åº”ç”¨éœ€è®¾ç½®baseRouteå¦‚ä¸‹ï¼š

  // main.ts
  import VueRouter from 'vue-router'
  import routes from './router'

  const router = new VueRouter({
    mode: 'history',
    // ğŸ‘‡ ç¯å¢ƒå˜é‡__MICRO_APP_BASE_ROUTE__ ä¸ºmicro-appæ³¨å…¥çš„åŸºç¡€è·¯ç”±
    base: window.__MICRO_APP_BASE_ROUTE__ || process.env.BASE_URL,
    routes,
  })


  ç„¶åè‹¥å­åº”ç”¨æ˜¯webpackæ„å»ºï¼Œéœ€å†è®¾ç½®webpackçš„publicPathï¼Œæ¥é¿å…å­åº”ç”¨çš„é™æ€èµ„æºä½¿ç”¨ç›¸å¯¹åœ°å€æ—¶åŠ è½½å¤±è´¥

  // ç¬¬ä¸€æ­¥ï¼Œå­åº”ç”¨æ ¹ç›®å½•srcä¸‹åˆ›å»ºpublick-path.jsï¼Œ æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š
  // __MICRO_APP_ENVIRONMENT__å’Œ__MICRO_APP_PUBLIC_PATH__æ˜¯ç”±micro-appæ³¨å…¥çš„å…¨å±€å˜é‡
  if (window.__MICRO_APP_ENVIRONMENT__) {
    // eslint-disable-next-line
    __webpack_public_path__ = window.__MICRO_APP_PUBLIC_PATH__
  }

  // ç¬¬äºŒæ­¥ï¼Œåœ¨å­åº”ç”¨çš„å…¥å£æ–‡ä»¶ æœ€é¡¶éƒ¨ å¼•å…¥public-path.js
  // entry
  import './public-path'
```

> ï¼ˆ2ï¼‰è‹¥å½“å‰åŸºåº§åº”ç”¨æ˜¯hashï¼Œå®˜æ–¹æ–‡æ¡£ä¸Šç›®å‰åªæ”¯æŒåŠ è½½hashè·¯ç”±çš„å­åº”ç”¨
```
åŸå› æ˜¯ï¼šåŸºåº§å¦‚æœæ˜¯hashçš„è·¯ç”±æ¨¡å¼ï¼Œå­åº”ç”¨æ˜¯historyè·¯ç”±æ¨¡å¼ï¼Œåœ¨å­åº”ç”¨å‘ç”Ÿå†…éƒ¨è·¯ç”±è·³è½¬æ—¶ï¼Œç”±äºhashçš„ä¼˜å…ˆçº§è¾ƒä½ï¼Œå¯èƒ½ä¼šå‘ç”Ÿhash çš„ä¸¢å¤±å¯¼è‡´é‡å®šå‘åˆ°é”™è¯¯é¡µé¢ã€‚
```
å¦‚æœéè¦åœ¨è¿™ç§è·¯ç”±æ¨¡å¼ä¸‹è¿›è¡ŒåµŒå…¥ï¼Œéœ€è¦ç›‘å¬å­åº”ç”¨è·¯ç”±å˜åŒ–ï¼Œå¹¶ä¸”åœ¨åŸºåº§åº”ç”¨ç»™historyè·¯ç”±åŒ…ä¸€å±‚ï¼Œåœ¨pushã€replaceçš„æ—¶å€™å°†hashé‡å†™åˆ°urlä¸Šã€‚

ä¾‹å¦‚ï¼š
```typescript
  beforeRouteEnter (to:any, from:any, next:any) {
    next()
    history.pushState(null, '', 'insight-center/label-market/#/trend-words/trend-center') // â€˜insight-center/label-marketâ€™ å’Œ 'trend-words/trend-center' åˆ†åˆ«æ˜¯å­åº”ç”¨å’ŒåŸºåº§åº”ç”¨çš„è·¯ç”±è·¯å¾„
  },
```

### **4ã€æ•°æ®é€šä¿¡**
ï¼ˆ1ï¼‰å­åº”ç”¨é€šè¿‡ç¯å¢ƒå˜é‡åˆ¤æ–­å½“å‰æ‰€å¤„ç¯å¢ƒæ˜¯å¦æ˜¯åµŒå…¥ç¯å¢ƒï¼Œé€šå¸¸å¯ç”¨äºå­åº”ç”¨åšä¸€äº›æ¨¡å—çš„æ˜¾ç¤ºéšè—å¤„ç†ã€‚
```javascript
if (window.__MICRO_APP_ENVIRONMENT__) {
  console.log('æˆ‘åœ¨å¾®å‰ç«¯ç¯å¢ƒä¸­')
}
```

ï¼ˆ2ï¼‰å­åº”ç”¨æ¥å—åŸºåº§åº”ç”¨æ•°æ®
```typescript
  // æ–¹æ³•1ï¼Œç›´æ¥è·å–
  // å­åº”ç”¨å¯ä»¥è·å–åŸºåº§çš„æ•°æ®æˆ–è€…å‡½æ•°
  // åœ¨å­åº”ç”¨è°ƒç”¨å›è°ƒå‡½æ•°åï¼Œå¯ä»¥å°†æ•°æ®ä¼ é€’å›åŸºåº§å¦‚ï¼šcallback?.(name)
  const { name, callback } = window.microApp.getData()
  

  // æ–¹æ³•2ï¼Œ ç»‘å®šç›‘å¬å‡½æ•°
  import microApp from '@micro-zoe/micro-app'
  
  const dataListener = (data) => {
    console.log('æ¥è‡ªåŸºåº§åº”ç”¨çš„æ•°æ®', data)
  }
  // ç»‘å®š
  // autoTrigger: åœ¨åˆæ¬¡ç»‘å®šç›‘å¬å‡½æ•°æ—¶å¦‚æœæœ‰ç¼“å­˜æ•°æ®ï¼Œæ˜¯å¦éœ€è¦ä¸»åŠ¨è§¦å‘ä¸€æ¬¡ï¼Œé»˜è®¤ä¸ºfalse
  window.microApp.addDataListener(dataListener: Function, autoTrigger?: boolean)
  // è§£é™¤æŸä¸ªç›‘å¬å‡½æ•°
  window.microApp.removeDataListener(dataListener: Function)
  // è§£é™¤æ‰€æœ‰ç›‘å¬å‡½æ•°
  window.microApp.clearDataListener()
```

ï¼ˆ3ï¼‰å­åº”ç”¨å‘åŸºåº§å‘æ¶ˆæ¯, é™¤äº†è°ƒç”¨åŸºåº§ä¸‹å‘çš„å›è°ƒå‡½æ•°å¤–ï¼Œè¿˜å¯ä»¥æ‰‹åŠ¨å‘é€æ¶ˆæ¯
``` typescript
  window.microApp.dispatch(message: Object as PropType<any>)
```

 
### **5ã€å­åº”ç”¨æ¥å…¥æ•ˆæœå›¾**

![image](https://raw.githubusercontent.com/wlin00/img/main/a9.png)





## å››ã€åŸºåº§åº”ç”¨æ”¹é€ ï¼šç”¨micro-appæ”¹é€ ç³»ç»Ÿä¸ºåŸºåº§åº”ç”¨ï¼Œç”¨äºåµŒå…¥å…¶ä»–ç³»ç»Ÿã€‚

é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å€ŸåŠ©å…¶ä»–å›¢é˜Ÿçš„æœç´¢å’Œè®¡ç®—èƒ½åŠ›ï¼ŒåŒæ—¶ä¸ºäº†ä¼˜åŒ–ä½“éªŒå’Œä¾¿æ·åœ°é€šä¿¡äº¤äº’ï¼Œé€‰æ‹©äº†æ”¹é€ vue2.xç³»ç»Ÿä¸ºåŸºåº§åº”ç”¨ï¼Œç”¨äºåµŒå…¥å…¶ä»–å›¢é˜Ÿçš„vue2.xç³»ç»Ÿã€‚è·¯ç”±æ¨¡å¼ï¼ŒåŸºåº§åº”ç”¨å’Œå­åº”ç”¨åˆ†åˆ«æ˜¯hashå’Œhistoryã€‚

### **1ã€åŸºåº§å®‰è£…ä¾èµ–**
```yarn
  yarn install @micro-zoe/micro-app -S
```

### **2ã€å…¥å£æ–‡ä»¶æ”¹é€ **
```typescript
import microApp from '@micro-zoe/micro-app'
// è§£å†³åŸºåº§åº”ç”¨ä¸­ï¼Œå› micro-appæœªå®šä¹‰å¯èƒ½çš„æŠ›å‡ºè­¦å‘Šé—®é¢˜ï¼š[Vue warn]: Unknown custom element: <micro-app>
Vue.config.ignoredElements = ['micro-app'] 
microApp.start()
```

### **3ã€è·¯ç”±è®¾ç½®**
ä¸ºå­åº”ç”¨å¼€æ”¾ä¸€ä¸ªè·¯ç”±ç”¨äºæ‰¿è½½micro-appçš„è‡ªå®šä¹‰æ ‡ç­¾customElements
```typescript
import { RouteConfig } from 'vue-router'
import Layout from '@/framework/layout/index.vue'
const nestedRoutes: RouteConfig = {
  path: '/trend-words',
  component: Layout,
  redirect: '/trend-words/search-words',
  name: 'TrendWords',
  meta: {},
  children: [
    // è¶‹åŠ¿ä¸­å¿ƒå…±å»ºï¼Œå¾®å‰ç«¯åµŒå…¥å—æµ·é¡µé¢
    { 
      path: 'trend-center',
      component: () => import(/* webpackChunkName: "trend-words/trend-center" */ '@/views/trend-words/trend-center/index.vue'),
      name: 'TrendWords-TrendCenter',
      meta: { hidden: false, editable: true }
    }
    ...
  ]
}
export default nestedRoutes
```
### **4ã€æ•°æ®é€šä¿¡**
ï¼ˆ1ï¼‰åŸºåº§åº”ç”¨å‘å­åº”ç”¨å‘æ¶ˆæ¯ï¼Œç±»ä¼¼å±æ€§ä¼ å€¼
```html
  <micro-app name="nanhai-uat" url="http://test.jd.com" :data="data" />
```

  (2)åŸºåº§æ‰‹åŠ¨å‘æ¶ˆæ¯
 ```javascript
  import microApp from '@micro-zoe/micro-app'
  // å‘é€æ•°æ®ç»™å­åº”ç”¨ my-appï¼ŒsetDataç¬¬äºŒä¸ªå‚æ•°åªæ¥å—å¯¹è±¡ç±»å‹
  microApp.setData('nanhai-uat', {type: 'æ–°çš„æ•°æ®'} as PropType<any>)
 ```

 (3) åŸºåº§è·å–å­åº”ç”¨æ•°æ®:
  
  ç¬¬ä¸€ç§ï¼Œç›´æ¥è·å–
 ```typescript
  import microApp from '@micro-zoe/micro-app'
  const childData = microApp.getData(appName) // è¿”å›å­åº”ç”¨çš„dataæ•°æ®
 ```

 ç¬¬äºŒç§ï¼Œç›‘å¬è‡ªå®šä¹‰äº‹ä»¶ (å­åº”ç”¨æ¯æ¬¡å‘é€æ•°æ®éƒ½ä¼šè§¦å‘datachange)
 ```html
  <micro-app name="nanhai-uat" url="http://test.jd.com"  @datachange='handleDataChange' />
 ```

 ç¬¬ä¸‰ç§ï¼Œç›‘å¬å‡½æ•°ç»‘å®š
 ```typescript
 import microApp from '@micro-zoe/micro-app'
 
  const dataListener = (data) => {
    console.log('æ¥è‡ªå­åº”ç”¨nanhaiçš„æ•°æ®', data)
  }
  // ç»™æŸä¸ªå­åº”ç”¨ç»‘å®šç›‘å¬å‡½æ•°
  const appName: String = 'nanhai-uat'
  // autoTrigger: åœ¨åˆæ¬¡ç»‘å®šç›‘å¬å‡½æ•°æ—¶å¦‚æœæœ‰ç¼“å­˜æ•°æ®ï¼Œæ˜¯å¦éœ€è¦ä¸»åŠ¨è§¦å‘ä¸€æ¬¡ï¼Œé»˜è®¤ä¸ºfalse
  window.microApp.addDataListener(appName, dataListener: Function, autoTrigger?: boolean)
  // è§£é™¤å¯¹åº”å­åº”ç”¨çš„æŸä¸ªç›‘å¬å‡½æ•°
  window.microApp.removeDataListener(appName, dataListener: Function)
  // è§£é™¤å¯¹åº”å­åº”ç”¨çš„æ‰€æœ‰ç›‘å¬å‡½æ•°
  window.microApp.clearDataListener(appName)
 ```

  ç¬¬å››ç§ï¼Œ è·å–å­åº”ç”¨å›è°ƒ
  
  å½“æˆ‘ä»¬ç»™åŸºåº§å‘æ¶ˆæ¯æ—¶ï¼Œ æˆ‘ä»¬å¯ä»¥é€‰æ‹©åœ¨dataå¯¹è±¡é‡Œä¼ å…¥ä¸€ä¸ªfunctionï¼Œå­åº”ç”¨æ‰§è¡Œå›è°ƒå‡½æ•°æ—¶, ä¹Ÿå¯ä»¥é€šçŸ¥åˆ°åŸºåº§åº”ç”¨ã€‚
  ```typescript
    // å­åº”ç”¨
    const microMethod = (window as any)?.microApp?.getData()?.merchantActivityInventory(this.planCodeInfo.promotionActivityId) // è·å–è¿”å›åŸºåº§åº”ç”¨ä¸»é¡µæ–¹æ³•
    microMethod?.push?.()
  ```


### **5ã€åŸºåº§åº”ç”¨å¤–å£³ä»£ç ç¤ºä¾‹**

```html

<template>
  <div class="trend-center-new">
    <micro-app 
      name="nanhai-uat"
      url="http://nanhai-uat.jd.com/"
      :data="dataForChild"
      @datachange="handleDataChange"
    ></micro-app>
  </div>
</template>

<script lang="ts">
  import { defineComponent, ref } from '@vue/composition-api'
  export default defineComponent({
    beforeRouteEnter (to:any, from:any, next:any) {
      next()
      history.pushState(null, '', 'insight-center/label-market/#/trend-words/trend-center')
    },
    components: {},
    props: {},
    setup (props:any, context:any) {
      // åŸºåº§å‘å­åº”ç”¨é€šè¿‡å±æ€§ä¼ å€¼çš„æ–¹å¼å‘æ•°æ®
      const dataForChild = ref({ type: 'æµ‹è¯•å‘æ¶ˆæ¯', editable: true })

      // å­åº”ç”¨æ¯æ¬¡å‘é€æ•°æ®éƒ½ä¼šè§¦å‘datachange, åŸºåº§å¯ä»¥ç”±æ­¤æ¥æ”¶æ•°æ®
      const handleDataChange = (data) => {
        console.log('data', data)
      }
      return {
        dataForChild,
        handleDataChange,
      }
    }
  })
</script>

<style lang="scss" scoped>
.trend-center-new {
  box-sizing: border-box;
}
</style>
```


### **6ã€åŸºåº§åº”ç”¨æ•ˆæœå›¾**

![image](https://raw.githubusercontent.com/wlin00/img/main/a10.png)


[å‚è€ƒèµ„æ–™ & micro-appå®˜æ–¹æ–‡æ¡£](https://zeroing.jd.com/micro-app/docs.html#/)