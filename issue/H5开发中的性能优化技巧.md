### 介绍
  在开发h5项目时，因h5页面可能放在流量较大的位置，作为落地页供b端、c端等用户使用，
  所以项目性能和打开速度会一定要求，下面记录一些优化方案。

### 优化方案
`1、设置meta标签：` ，设置meta标签的content属性，禁止用户缩放的同时，避免了300ms的点击时延。
```html    
  <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0">
```

`2、css和js资源位置：` css放头部，js放尾部。因为js引擎线程和渲染线程互斥，到浏览器解析到非动态加载、非异步加载的script标签时，会阻塞html的解析过程，而css放头部是为了让html的下载和解析和css同步执行，不阻塞dom的渲染，这一点webpack构建时会进行处理。

`3、资源混淆压缩：` 减少资源大小，作用是减少页面资源大小，同时降低代码的可读性来起到一定的安全性。可通过配置UglifyJS Webpack Plugin压缩js文件，一般脚手架里会默认设置。

`4、资源gzip压缩：` 将资源大幅度缩小，如果资源放在cdn上，会有默认的gzip配置。若资源没放在cdn，则可通过应用服务器里配置nginx实现，即配置 
```
http { 
  gzip  on; 
}
```

`5、资源合并：` 减少请求数量， 对于同个域名，浏览器中最多并行6个请求，超出的请求会进入请求队列等待。减少请求数量可以减少tcp握手次数，并减少网络抖动的影响。目前工程化实践中，webpack会默认对node_modules中的第三方包进行合并，将其合并为一个chunk包。

`6、图片处理：` 可通过tinyPng来压缩png图片，缩小资源体积；当一个项目中图片较多时，可考虑图片做雪碧图来减少请求数量；对于多色图标、方向不一致的图标可使用svg调整其颜色和方向；base64处理，一般对4kb以下的图片做base6。

`7、http缓存：` 首次访问后二次访问本地资源，减少请求数量。http缓存建议加在cdn、或打包出来的带hash的chunk资源上。

`8、图片懒加载：` 图片较多时可考虑使用，让用户滚动屏幕到下一屏的时候才请求更多的图片资源，可以考虑手写实现、vue-lazyload、react-lazyload等组件实现。

`9、路由懒加载：` 将页面的js代码拆分为一个个的chunk包，等到需要加载相应页面的时候去加载页面资源。用户经常访问的页面，不用路由懒加载，对于用户经常访问的页面，因为用户肯定需要将页面的 chunk js 加载下来才可以访问页面，路由懒加载会导致先加载 资源清单 manifest 文件，再去加载页面的 chunk 包，这样就形成了一个资源的串行请求，本来可以一次加载下来却非得拆分成2次而且还是串行的不是并行的。

`10、组件库按需引入：` 减少资源大小，例如通过babel配置按需引入，减少引入组件个数。
```
  "plugins": [
    ["import", {
      "libraryName": "wot-design",
      "style": true
    }]
  ]
```

`11、资源做preload和prefetch：` 提前加载要用到的资源，等需要请求的时候直接使用加载好的资源执行，preload提前加载当前页面用到的资源，prefetc提前家在下个页面用到的资源，都不提前执行。对于前后分离的项目，使用了路由懒加载，这时候prefetch可以提前加载下个页面的资源，让用户无感切换页面。vue3.0开始脚手架默认携带此功能，自己配置的时候可以使用 @vue/preload-webpack-plugin插件。


